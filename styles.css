:root {
  --bg-main: #0a4e8a;
  --bg-dialog: #c0c0c0;
  --title-active: #000080;
  --title-inactive: #6b6b6b;
  --frame-dark: #3f3f3f;
  --frame-mid: #7b7b7b;
  --frame-light: #ffffff;
  --frame-soft: #d4d0c8;
  --text-main: #111;
  --taskbar-bg: #c0c0c0;
  --accent-red: #7f0000;
  --content-bg: #efefef;
  --content-alt-bg: #e8e8e8;
  --content-pre-bg: #dfdfdf;
  --window-status-bg: #d6d6d6;
  --clock-bg: #c0c0c0;
  --icon-hover: #cdd8f3;
  --desktop-icon-text: #081013;
  --boot-screen-bg: #020708;
  --boot-screen-text: #9ec5c5;
  --boot-progress-border: #365050;
  --boot-seg-off: #0e1a1a;
  --boot-seg-on: #5ca2a2;
  --bg-pattern: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='8' height='8'%3E%3Crect width='8' height='8' fill='%230a4e8a'/%3E%3Crect width='8' height='1' y='1' fill='%230958a0'/%3E%3Crect width='4' height='1' y='4' fill='%23073f71'/%3E%3C/svg%3E");
  --bg-pattern-size: auto;

  font-family: "MS Sans Serif", "Tahoma", "Geneva", monospace;
  font-size: 10px;
  font-weight: 700;
}

[data-theme="win95"] {
  --bg-main: #0a4e8a;
  --bg-dialog: #c0c0c0;
  --title-active: #000080;
  --title-inactive: #6b6b6b;
  --taskbar-bg: #c0c0c0;
  --bg-pattern: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='8' height='8'%3E%3Crect width='8' height='8' fill='%230a4e8a'/%3E%3Crect width='8' height='1' y='1' fill='%230958a0'/%3E%3Crect width='4' height='1' y='4' fill='%23073f71'/%3E%3C/svg%3E");
}

[data-theme="plus-nature"] {
  --bg-main: #5b7f4f;
  --bg-dialog: #d8d2bb;
  --title-active: #355a2b;
  --title-inactive: #6a7f61;
  --taskbar-bg: #c2b99d;
  --content-bg: #ece5cc;
  --content-alt-bg: #f4edd7;
  --content-pre-bg: #ddd5ba;
  --window-status-bg: #cec4a6;
  --icon-hover: #b9ccb0;
  --bg-pattern: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='10' height='10'%3E%3Crect width='10' height='10' fill='%235b7f4f'/%3E%3Ccircle cx='2' cy='2' r='1' fill='%236f9461'/%3E%3Ccircle cx='7' cy='6' r='1' fill='%237ca26e'/%3E%3C/svg%3E");
}

[data-theme="plus-space"] {
  --bg-main: #171a3a;
  --bg-dialog: #c2c5d6;
  --title-active: #232c7c;
  --title-inactive: #545f8e;
  --taskbar-bg: #aeb3c8;
  --content-bg: #e0e3f1;
  --content-alt-bg: #ecedf6;
  --content-pre-bg: #d2d6eb;
  --window-status-bg: #c7cce0;
  --icon-hover: #b6c0e4;
  --bg-pattern: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12'%3E%3Crect width='12' height='12' fill='%23171a3a'/%3E%3Ccircle cx='2' cy='2' r='1' fill='%23dce4ff'/%3E%3Ccircle cx='8' cy='4' r='1' fill='%23a6b6ff'/%3E%3Ccircle cx='5' cy='9' r='1' fill='%23ffffff'/%3E%3C/svg%3E");
}

[data-theme="inside-computer"] {
  --bg-main: #1d4f23;
  --bg-dialog: #adc8af;
  --title-active: #0d2f10;
  --title-inactive: #3d6541;
  --taskbar-bg: #8bb28f;
  --content-bg: #d6e8d8;
  --content-alt-bg: #e5f0e5;
  --content-pre-bg: #c8dbc8;
  --window-status-bg: #b8d0b9;
  --icon-hover: #9fc5a1;
  --text-main: #041205;
  --bg-pattern: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='8' height='8'%3E%3Crect width='8' height='8' fill='%231d4f23'/%3E%3Cpath d='M0 1h8M0 4h8M0 7h8' stroke='%23286a30' stroke-width='1'/%3E%3C/svg%3E");
}

[data-theme="active-desktop"] {
  --bg-main: #3f6cb5;
  --bg-dialog: #d3dff1;
  --title-active: #144a92;
  --title-inactive: #5b79a8;
  --taskbar-bg: #b7c8e6;
  --content-bg: #edf3ff;
  --content-alt-bg: #f6f9ff;
  --content-pre-bg: #dde8fb;
  --window-status-bg: #cfddf5;
  --icon-hover: #d0e0fb;
  --bg-pattern: radial-gradient(circle at 20% 20%, #5e8fe0 0%, #3f6cb5 60%, #2d4f85 100%);
}

[data-theme="oem-pc"] {
  --bg-main: #6e8a98;
  --bg-dialog: #d9dad2;
  --title-active: #1b4257;
  --title-inactive: #526874;
  --taskbar-bg: #bcc0ba;
  --content-bg: #ecece5;
  --content-alt-bg: #f3f3ee;
  --content-pre-bg: #ddddd6;
  --window-status-bg: #d3d3cc;
  --icon-hover: #ced4d1;
  --bg-pattern: linear-gradient(135deg, #809ba8 25%, #6e8a98 25%, #6e8a98 50%, #809ba8 50%, #809ba8 75%, #6e8a98 75%, #6e8a98 100%);
  --bg-pattern-size: 10px 10px;
}

[data-theme="litestep"] {
  --bg-main: #0b0b0b;
  --bg-dialog: #1f1f1f;
  --title-active: #00d18f;
  --title-inactive: #2d6d53;
  --frame-dark: #010101;
  --frame-mid: #1e1e1e;
  --frame-light: #3de5b1;
  --taskbar-bg: #121212;
  --text-main: #8ef5d2;
  --content-bg: #141414;
  --content-alt-bg: #1a1a1a;
  --content-pre-bg: #0f0f0f;
  --window-status-bg: #101010;
  --clock-bg: #0e0e0e;
  --icon-hover: #0e3124;
  --desktop-icon-text: #a7ffd8;
  --boot-screen-bg: #000;
  --boot-screen-text: #00ef9f;
  --boot-progress-border: #00aa6f;
  --boot-seg-off: #001f14;
  --boot-seg-on: #00ef9f;
  --bg-pattern: repeating-linear-gradient(180deg, #080808 0, #080808 2px, #0f0f0f 2px, #0f0f0f 4px);
}

[data-theme="high-contrast-retro"] {
  --bg-main: #000;
  --bg-dialog: #fff;
  --title-active: #000;
  --title-inactive: #333;
  --frame-dark: #000;
  --frame-mid: #000;
  --frame-light: #fff;
  --taskbar-bg: #fff;
  --text-main: #000;
  --content-bg: #fff;
  --content-alt-bg: #fff;
  --content-pre-bg: #fff;
  --window-status-bg: #fff;
  --clock-bg: #fff;
  --icon-hover: #ff0;
  --desktop-icon-text: #fff;
  --accent-red: #000;
  --bg-pattern: none;
}

[data-theme="office-1996"] {
  --bg-main: #7b8694;
  --bg-dialog: #d8d4cf;
  --title-active: #2c3f66;
  --title-inactive: #5d6876;
  --taskbar-bg: #b9b6b2;
  --content-bg: #ece9e4;
  --content-alt-bg: #f4f2ee;
  --content-pre-bg: #ddd9d2;
  --window-status-bg: #cecbc4;
  --icon-hover: #cad0d8;
  --bg-pattern: linear-gradient(45deg, #7b8694 25%, #8f99a6 25%, #8f99a6 50%, #7b8694 50%, #7b8694 75%, #8f99a6 75%, #8f99a6 100%);
  --bg-pattern-size: 12px 12px;
}

[data-theme="calmira"] {
  --bg-main: #0a7f7f;
  --bg-dialog: #c0c0c0;
  --title-active: #000080;
  --title-inactive: #666;
  --taskbar-bg: #c0c0c0;
  --content-bg: #efefef;
  --content-alt-bg: #f6f6f6;
  --content-pre-bg: #e0e0e0;
  --window-status-bg: #d3d3d3;
  --icon-hover: #bcd9d9;
  --bg-pattern: linear-gradient(180deg, #0a8f8f 0%, #0a7f7f 100%);
}

* {
  box-sizing: border-box;
  border-radius: 0;
  text-rendering: geometricPrecision;
  image-rendering: pixelated;
}

html,
body {
  margin: 0;
  height: 100%;
}

body {
  background-color: var(--bg-main);
  background-image: var(--bg-pattern);
  background-size: var(--bg-pattern-size);
  color: var(--text-main);
  overflow: hidden;
}

button,
input,
textarea {
  font: inherit;
}

.hidden {
  display: none !important;
}

.desktop {
  position: fixed;
  inset: 2px 0 28px 2px;
  display: grid;
  gap: 4px;
  width: min-content;
  align-content: start;
}

.desktop-icon {
  width: 74px;
  min-height: 56px;
  border: 1px solid transparent;
  background: transparent;
  color: var(--desktop-icon-text);
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  gap: 1px;
  padding: 2px;
  cursor: default;
}

.desktop-icon:hover,
.desktop-icon:focus-visible {
  border: 1px dotted #111;
  background: var(--icon-hover);
}

.desktop-icon span:last-child {
  text-align: center;
  line-height: 1.05;
}

.icon-pixel {
  font-size: 16px;
}

.taskbar {
  position: fixed;
  left: 0;
  right: 0;
  bottom: 0;
  height: 28px;
  padding: 2px;
  display: grid;
  grid-template-columns: auto 1fr auto;
  gap: 3px;
  align-items: center;
  background: var(--taskbar-bg);
  border-top: 2px solid var(--frame-light);
  border-left: 2px solid var(--frame-light);
  border-right: 2px solid var(--frame-dark);
}

.start-button,
.taskbar-app,
.start-menu button,
.window-controls button,
.system-message button,
.theme-switcher button,
.winamp-controls button {
  background: var(--taskbar-bg);
  border-top: 2px solid var(--frame-light);
  border-left: 2px solid var(--frame-light);
  border-right: 2px solid var(--frame-dark);
  border-bottom: 2px solid var(--frame-dark);
  padding: 1px 5px;
  min-height: 20px;
}

.start-button:active,
.start-button[aria-expanded="true"],
.taskbar-app:active,
.taskbar-app.active,
.start-menu button:active,
.window-controls button:active,
.system-message button:active,
.theme-switcher button:active,
.winamp-controls button:active {
  border-top-color: var(--frame-dark);
  border-left-color: var(--frame-dark);
  border-right-color: var(--frame-light);
  border-bottom-color: var(--frame-light);
}

.taskbar-apps {
  display: flex;
  gap: 2px;
  min-width: 0;
}

.taskbar-app {
  min-width: 96px;
  max-width: 154px;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  text-align: left;
}

.taskbar-right {
  display: flex;
  align-items: center;
  gap: 3px;
}

.task-icon {
  width: 18px;
  height: 18px;
  display: grid;
  place-items: center;
  border-top: 1px solid var(--frame-light);
  border-left: 1px solid var(--frame-light);
  border-right: 1px solid var(--frame-dark);
  border-bottom: 1px solid var(--frame-dark);
  background: var(--clock-bg);
}

.clock {
  min-width: 60px;
  text-align: center;
  background: var(--clock-bg);
  border-top: 2px solid var(--frame-mid);
  border-left: 2px solid var(--frame-mid);
  border-right: 2px solid var(--frame-light);
  border-bottom: 2px solid var(--frame-light);
  padding: 1px 4px;
}

.start-menu {
  position: fixed;
  left: 2px;
  bottom: 30px;
  width: 340px;
  display: grid;
  grid-template-columns: 20px 1fr;
  background: var(--taskbar-bg);
  border-top: 2px solid var(--frame-light);
  border-left: 2px solid var(--frame-light);
  border-right: 2px solid var(--frame-dark);
  border-bottom: 2px solid var(--frame-dark);
}

.start-menu-banner {
  writing-mode: vertical-rl;
  transform: rotate(180deg);
  text-align: center;
  color: #f4f7f4;
  background: var(--title-active);
  letter-spacing: 0.6px;
  padding: 3px 0;
}

.start-menu-items {
  padding: 4px;
  display: grid;
  gap: 2px;
}

.start-menu button {
  text-align: left;
  width: 100%;
}

.start-menu hr {
  border: 0;
  border-top: 1px solid var(--frame-mid);
  border-bottom: 1px solid var(--frame-light);
  width: 100%;
  margin: 2px 0;
}

.menu-label {
  margin: 0;
}

.theme-switcher {
  display: grid;
  grid-template-columns: 1fr;
  gap: 2px;
}

.window {
  position: absolute;
  width: min(420px, 90vw);
  min-height: 180px;
  background: var(--bg-dialog);
  border-top: 2px solid var(--frame-light);
  border-left: 2px solid var(--frame-light);
  border-right: 2px solid var(--frame-dark);
  border-bottom: 2px solid var(--frame-dark);
}

.window-header {
  background: var(--title-inactive);
  color: #dce7e7;
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 2px 2px 2px 4px;
  cursor: move;
  user-select: none;
}

.window.active .window-header {
  background: var(--title-active);
  color: #fff;
}

.window-title {
  text-transform: uppercase;
  letter-spacing: 0.7px;
}

.window-controls {
  display: flex;
  gap: 1px;
}

.window-controls button {
  width: 18px;
  min-height: 16px;
  line-height: 1;
  padding: 0;
}

.window-controls .close {
  background: var(--accent-red);
  color: #fff;
}

.window-content {
  margin: 2px;
  padding: 4px;
  min-height: 120px;
  border-top: 2px solid var(--frame-mid);
  border-left: 2px solid var(--frame-mid);
  border-right: 2px solid var(--frame-light);
  border-bottom: 2px solid var(--frame-light);
  background: var(--content-bg);
  line-height: 1.2;
}

.window-content textarea {
  width: 100%;
  min-height: 100px;
  resize: none;
  border-top: 2px solid var(--frame-mid);
  border-left: 2px solid var(--frame-mid);
  border-right: 2px solid var(--frame-light);
  border-bottom: 2px solid var(--frame-light);
  background: var(--content-alt-bg);
  padding: 2px;
}


.window-content pre {
  margin: 3px 0 0;
  padding: 3px;
  max-height: 185px;
  overflow: auto;
  border-top: 2px solid var(--frame-mid);
  border-left: 2px solid var(--frame-mid);
  border-right: 2px solid var(--frame-light);
  border-bottom: 2px solid var(--frame-light);
  background: var(--content-pre-bg);
  font-family: "Courier New", monospace;
  font-size: 9px;
  line-height: 1.2;
}

.window-content button {
  background: var(--taskbar-bg);
  border-top: 2px solid var(--frame-light);
  border-left: 2px solid var(--frame-light);
  border-right: 2px solid var(--frame-dark);
  border-bottom: 2px solid var(--frame-dark);
  padding: 1px 5px;
  min-height: 18px;
}

.window-content button:active {
  border-top-color: var(--frame-dark);
  border-left-color: var(--frame-dark);
  border-right-color: var(--frame-light);
  border-bottom-color: var(--frame-light);
}

.systems-controls {
  display: flex;
  flex-wrap: wrap;
  gap: 3px 6px;
  align-items: center;
}

.window-content input[type="checkbox"] {
  appearance: none;
  width: 11px;
  height: 11px;
  margin-right: 4px;
  vertical-align: middle;
  border-top: 2px solid var(--frame-mid);
  border-left: 2px solid var(--frame-mid);
  border-right: 2px solid var(--frame-light);
  border-bottom: 2px solid var(--frame-light);
  background: #f7f3e7;
}

.window-content input[type="checkbox"]:checked::after {
  content: "â– ";
  font-size: 8px;
  position: relative;
  left: 1px;
  top: -2px;
}

.window-status {
  margin: 0 2px 2px;
  padding: 2px 4px;
  min-height: 16px;
  border-top: 1px solid var(--frame-mid);
  background: var(--window-status-bg);
}

.boot-screen {
  position: fixed;
  inset: 0;
  background: var(--boot-screen-bg);
  color: var(--boot-screen-text);
  padding: 16px;
}

.bios-log {
  margin: 0 0 10px;
  font-family: "Courier New", monospace;
  font-size: 11px;
}

.boot-progress {
  width: 240px;
  border: 2px solid var(--boot-progress-border);
  padding: 2px;
}

.boot-progress-segments {
  display: grid;
  grid-template-columns: repeat(20, 1fr);
  gap: 1px;
  min-height: 12px;
}

.boot-seg {
  background: var(--boot-seg-off);
}

.boot-seg.on {
  background: var(--boot-seg-on);
}

.boot-hint {
  margin-top: 6px;
}

.system-message {
  position: fixed;
  right: 14px;
  bottom: 42px;
  width: 260px;
  padding: 3px;
  background: var(--bg-dialog);
  border-top: 2px solid var(--frame-light);
  border-left: 2px solid var(--frame-light);
  border-right: 2px solid var(--frame-dark);
  border-bottom: 2px solid var(--frame-dark);
  z-index: 5000;
}

.message-header {
  background: var(--title-active);
  color: #fff;
  padding: 2px 4px;
  margin-bottom: 5px;
}

.system-message p {
  margin: 0 0 5px;
}

.winamp-player {
  background: #c9c0aa;
  border-top: 2px solid var(--frame-light);
  border-left: 2px solid var(--frame-light);
  border-right: 2px solid var(--frame-dark);
  border-bottom: 2px solid var(--frame-dark);
  padding: 3px;
}

.winamp-display {
  border-top: 2px solid var(--frame-mid);
  border-left: 2px solid var(--frame-mid);
  border-right: 2px solid var(--frame-light);
  border-bottom: 2px solid var(--frame-light);
  background: #151f1f;
  color: #9fd5b4;
  padding: 3px;
  margin-bottom: 4px;
}

.winamp-track,
.winamp-time,
.winamp-hint {
  margin: 0;
}

.winamp-progress-wrap {
  margin-bottom: 4px;
}

.winamp-progress {
  width: 100%;
}


.winamp-controls {
  display: flex;
  gap: 2px;
  flex-wrap: wrap;
}

.winamp-controls button {
  min-width: 46px;
  padding: 1px 4px;
}

.winamp-controls-secondary {
  margin-top: 3px;
}

.winamp-meta-grid {
  margin-top: 4px;
  padding: 3px;
  border-top: 1px solid var(--frame-mid);
  border-left: 1px solid var(--frame-mid);
  border-right: 1px solid var(--frame-light);
  border-bottom: 1px solid var(--frame-light);
  background: #d1c8b4;
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 2px 6px;
  align-items: center;
}

.winamp-stat {
  margin: 0;
}

.winamp-volume-wrap {
  display: flex;
  align-items: center;
  gap: 3px;
}

.winamp-volume {
  width: 100%;
}

.winamp-player audio {
  display: none;
}

/* Immersion polish overrides */
.desktop {
  position: fixed;
  inset: 2px 0 28px 2px;
  display: block;
}
.desktop-icon {
  position: absolute;
  width: 78px;
  min-height: 62px;
}
.desktop-icon.selected {
  border: 1px dotted #111;
  background: var(--icon-hover);
}
.desktop-icon span:last-child {
  max-width: 74px;
  white-space: normal;
  word-break: break-word;
}
.selection-box {
  position: absolute;
  border: 1px dotted #fff;
  background: rgba(0, 0, 120, 0.2);
  pointer-events: none;
}
.start-button:hover,
.taskbar-app:hover,
.start-menu button:hover,
.desktop-menu button:hover,
.window-content button:hover {
  background: var(--icon-hover);
}
.start-button[aria-expanded="true"] {
  transform: translateY(1px);
}
.clock {
  cursor: default;
}
.window {
  transition: transform 120ms steps(3), opacity 120ms linear;
  transform-origin: top left;
}
.window.opening { transform: scale(0.95); opacity: 0.4; }
.window.closing { opacity: 0; }
.window.minimizing { transform: scale(0.6); opacity: 0.2; }
.desktop-menu {
  position: fixed;
  z-index: 4000;
  width: 170px;
  padding: 3px;
  background: var(--taskbar-bg);
  border-top: 2px solid var(--frame-light);
  border-left: 2px solid var(--frame-light);
  border-right: 2px solid var(--frame-dark);
  border-bottom: 2px solid var(--frame-dark);
}
.desktop-menu button { width: 100%; text-align: left; margin-bottom: 2px; }
.boot-phase { margin: 0 0 6px; }
.boot-modules {
  margin: 0 0 8px;
  min-height: 70px;
  max-height: 110px;
  overflow: hidden;
  font-family: "Courier New", monospace;
}
.boot-progress { width: min(420px, 92vw); }
.boot-progress-fill {
  height: 14px;
  width: 0;
  background: repeating-linear-gradient(90deg, var(--boot-seg-on) 0 12px, #458282 12px 14px);
}
.setup-wizard {
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.5);
  display: grid;
  place-items: center;
  z-index: 6000;
}
.wizard-box {
  width: 280px;
  background: var(--bg-dialog);
  padding: 6px;
  border-top: 2px solid var(--frame-light);
  border-left: 2px solid var(--frame-light);
  border-right: 2px solid var(--frame-dark);
  border-bottom: 2px solid var(--frame-dark);
  display: grid;
  gap: 6px;
}
.wizard-box header { background: var(--title-active); color: #fff; padding: 3px; }
.wizard-box input, .wizard-box select {
  width: 100%;
  border-top: 2px solid var(--frame-mid);
  border-left: 2px solid var(--frame-mid);
  border-right: 2px solid var(--frame-light);
  border-bottom: 2px solid var(--frame-light);
}
.window-content .tree { font-family: "Courier New", monospace; background: var(--content-pre-bg); padding: 4px; }
